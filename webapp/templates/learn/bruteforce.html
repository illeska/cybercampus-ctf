{% extends "base.html" %}
{% block title %}Cours : Attaques par Force Brute - CyberCampus CTF{% endblock %}

{% block content %}
<section class="page-wrapper course-page">
  
  <!-- Breadcrumb -->
  <div class="breadcrumb">
    <a href="{{ url_for('learn') }}">ğŸ“š BibliothÃ¨que</a>
    <span class="separator">/</span>
    <span class="current">Attaques par Force Brute</span>
  </div>

  <!-- En-tÃªte du cours -->
  <div class="course-header">
    <div class="course-header-icon">ğŸ”¨</div>
    <div class="course-header-content">
      <h1>Attaques par Force Brute (Bruteforce)</h1>
      <p class="course-subtitle">Comprendre et se protÃ©ger contre les attaques par essais successifs</p>
      <div class="course-badges">
        <span class="badge-high">Ã‰levÃ©</span>
        <span class="badge-time">ğŸ“– 18 min</span>
        <span class="badge-level">âš¡ DÃ©butant</span>
      </div>
    </div>
  </div>

  <!-- Contenu du cours -->
  <div class="course-content">

    <!-- Section 1 -->
    <div class="course-section">
      <h2>ğŸ” Qu'est-ce qu'une attaque par force brute ?</h2>
      <p>
        Une attaque par <strong>force brute</strong> (ou bruteforce) est une mÃ©thode simple mais efficace qui consiste Ã  
        <strong>tester systÃ©matiquement toutes les combinaisons possibles</strong> jusqu'Ã  trouver la bonne. 
        C'est comme essayer toutes les clÃ©s d'un trousseau jusqu'Ã  trouver celle qui ouvre la serrure.
      </p>
      <p>
        Contrairement aux attaques par injection (SQLi, XSS) qui exploitent des failles de programmation, 
        le bruteforce exploite simplement le <strong>manque de protection</strong> contre les tentatives rÃ©pÃ©tÃ©es. 
        Si un systÃ¨me ne limite pas le nombre d'essais, un attaquant peut tester des milliers, voire des millions 
        de combinaisons.
      </p>
      
      <div class="info-box">
        <div class="info-icon">ğŸ’¡</div>
        <div class="info-content">
          <strong>Exemple concret :</strong>
          <p>
            Imaginez un cadenas Ã  4 chiffres (0000 Ã  9999). Il existe 10 000 combinaisons possibles. 
            En testant chaque combinaison une par une, vous Ãªtes CERTAIN de l'ouvrir en maximum 10 000 essais. 
            C'est le principe du bruteforce : la patience et la persÃ©vÃ©rance remplacent l'intelligence.
          </p>
        </div>
      </div>
    </div>

    <!-- Section 2 -->
    <div class="course-section">
      <h2>ğŸ¯ Les diffÃ©rents types de bruteforce</h2>
      
      <div class="attack-types">
        <div class="attack-type-card">
          <h4>ğŸ”¤ Bruteforce Simple</h4>
          <p>Teste toutes les combinaisons possibles de caractÃ¨res, lettre par lettre.</p>
          <div class="code-snippet">
            <code>a, b, c, ... aa, ab, ac, ... aaa, aab, ...</code>
          </div>
          <p style="margin-top: 10px; font-size: 0.85rem; color: #94a3b8;">
            â±ï¸ <strong>TrÃ¨s lent</strong> mais garantit de trouver le mot de passe
          </p>
        </div>

        <div class="attack-type-card">
          <h4>ğŸ“– Attaque par Dictionnaire</h4>
          <p>Teste une liste de mots de passe courants (dictionnaire).</p>
          <div class="code-snippet">
            <code>password, 123456, admin, qwerty, ...</code>
          </div>
          <p style="margin-top: 10px; font-size: 0.85rem; color: #94a3b8;">
            âš¡ <strong>TrÃ¨s rapide</strong> si le mot de passe est commun
          </p>
        </div>

        <div class="attack-type-card">
          <h4>ğŸ­ Attaque Hybride</h4>
          <p>Combine dictionnaire + variations (ajout de chiffres, majuscules, symboles).</p>
          <div class="code-snippet">
            <code>password â†’ Password1, p@ssword, password123</code>
          </div>
          <p style="margin-top: 10px; font-size: 0.85rem; color: #94a3b8;">
            âš–ï¸ <strong>Ã‰quilibrÃ©</strong> entre vitesse et efficacitÃ©
          </p>
        </div>
      </div>

      <div class="info-box" style="margin-top: 25px;">
        <div class="info-icon">ğŸ“Š</div>
        <div class="info-content">
          <strong>Statistiques impressionnantes :</strong>
          <p>
            Avec une machine moderne, on peut tester environ <strong>10 milliards de combinaisons par seconde</strong> 
            pour des hashes MD5. Cela signifie qu'un mot de passe de 6 caractÃ¨res alphanumÃ©riques 
            (62^6 = 56 milliards de combinaisons) peut Ãªtre crackÃ© en moins de 6 secondes !
          </p>
        </div>
      </div>
    </div>

    <!-- Section 3 -->
    <div class="course-section">
      <h2>âš™ï¸ Comment fonctionne une attaque par dictionnaire ?</h2>
      <p>Prenons l'exemple d'un formulaire de connexion non protÃ©gÃ© :</p>
      
      <div class="code-block vulnerable">
        <div class="code-header">
          <span class="code-status">âŒ Code vulnÃ©rable</span>
          <span class="code-lang">Python / Flask</span>
        </div>
        <pre><code>@app.route('/login', methods=['POST'])
def login():
    username = request.form['username']
    password = request.form['password']
    
    # VÃ©rification simple sans limitation
    if username == 'admin' and password == 'secret123':
        return "Connexion rÃ©ussie !"
    else:
        return "Identifiants incorrects"</code></pre>
      </div>

      <p>Ce code prÃ©sente <strong>plusieurs faiblesses critiques</strong> :</p>

      <div class="explanation-box">
        <h4>Pourquoi ce code est vulnÃ©rable ?</h4>
        <ul>
          <li><strong>Aucune limitation du nombre de tentatives</strong> - On peut essayer infiniment</li>
          <li><strong>Pas de dÃ©lai entre les tentatives</strong> - On peut envoyer des milliers de requÃªtes par seconde</li>
          <li><strong>Pas de blocage temporaire</strong> - Le compte n'est jamais verrouillÃ©</li>
          <li><strong>RÃ©ponse instantanÃ©e</strong> - Aucun ralentissement artificiel</li>
          <li><strong>Pas de CAPTCHA</strong> - Un script automatisÃ© peut fonctionner sans interruption</li>
        </ul>
      </div>

      <h3>ScÃ©nario d'attaque avec un script Python :</h3>
      
      <div class="code-block">
        <div class="code-header">
          <span class="code-status">ğŸ”´ Script d'attaque</span>
          <span class="code-lang">Python</span>
        </div>
        <pre><code>import requests

# Liste de mots de passe courants
passwords = ['123456', 'password', 'admin', 'qwerty', 'secret123', '12345']

url = 'http://site-vulnerable.com/login'

for pwd in passwords:
    data = {'username': 'admin', 'password': pwd}
    response = requests.post(url, data=data)
    
    if "Connexion rÃ©ussie" in response.text:
        print(f"âœ… Mot de passe trouvÃ© : {pwd}")
        break
    else:
        print(f"âŒ Ã‰chec avec : {pwd}")</code></pre>
      </div>

      <div class="example-box">
        <strong>RÃ©sultat de l'attaque :</strong>
        <code>âŒ Ã‰chec avec : 123456
âŒ Ã‰chec avec : password
âŒ Ã‰chec avec : admin
âŒ Ã‰chec avec : qwerty
âœ… Mot de passe trouvÃ© : secret123</code>
        <p style="margin-top: 10px;">
          En quelques secondes, l'attaquant a testÃ© 5 mots de passe et trouvÃ© le bon. 
          Avec une liste de 10 000 mots de passe, cela prendrait quelques minutes seulement.
        </p>
      </div>
    </div>

    <!-- Section 4 -->
    <div class="course-section">
      <h2>ğŸ›¡ï¸ Comment se protÃ©ger efficacement ?</h2>
      <p>La protection contre le bruteforce repose sur plusieurs couches de dÃ©fense :</p>

      <div class="protection-method">
        <div class="method-number">1</div>
        <div class="method-content">
          <h3>Limitation du nombre de tentatives (Rate Limiting)</h3>
          <p>Limitez le nombre d'essais autorisÃ©s dans une pÃ©riode donnÃ©e.</p>
          
          <div class="code-block safe">
            <div class="code-header">
              <span class="code-status">âœ… Code sÃ©curisÃ©</span>
              <span class="code-lang">Python / Flask</span>
            </div>
            <pre><code>from flask_limiter import Limiter
from flask_limiter.util import get_remote_address

limiter = Limiter(
    app,
    key_func=get_remote_address,
    default_limits=["200 per day", "50 per hour"]
)

@app.route('/login', methods=['POST'])
@limiter.limit("5 per minute")  # Max 5 tentatives par minute
def login():
    # ... code de connexion ...</code></pre>
          </div>

          <div class="success-box">
            <strong>RÃ©sultat :</strong> AprÃ¨s 5 tentatives Ã©chouÃ©es en une minute, l'attaquant doit attendre. 
            Avec cette limite, tester 10 000 mots de passe prendrait plus de 33 heures au lieu de quelques minutes !
          </div>
        </div>
      </div>

      <div class="protection-method">
        <div class="method-number">2</div>
        <div class="method-content">
          <h3>DÃ©lai progressif (Progressive Delay)</h3>
          <p>Augmentez le temps d'attente aprÃ¨s chaque Ã©chec successif.</p>
          
          <div class="code-block safe">
            <div class="code-header">
              <span class="code-status">âœ… Code sÃ©curisÃ©</span>
              <span class="code-lang">Python</span>
            </div>
            <pre><code>import time

failed_attempts = {}  # {ip: nombre_d_echecs}

@app.route('/login', methods=['POST'])
def login():
    ip = request.remote_addr
    
    # RÃ©cupÃ©rer le nombre d'Ã©checs pour cette IP
    attempts = failed_attempts.get(ip, 0)
    
    # DÃ©lai progressif : 2^n secondes (1s, 2s, 4s, 8s, ...)
    if attempts > 0:
        delay = min(2 ** attempts, 60)  # Max 60 secondes
        time.sleep(delay)
    
    # VÃ©rification des identifiants
    if verify_credentials(username, password):
        failed_attempts[ip] = 0  # Reset en cas de succÃ¨s
        return "Connexion rÃ©ussie"
    else:
        failed_attempts[ip] = attempts + 1
        return "Identifiants incorrects"</code></pre>
          </div>

          <div class="transformation-box">
            <div class="transform-before">
              <strong>Sans dÃ©lai progressif :</strong>
              <code>1000 essais = 10 secondes</code>
            </div>
            <div class="transform-arrow">â†’</div>
            <div class="transform-after">
              <strong>Avec dÃ©lai progressif :</strong>
              <code>1000 essais = plusieurs heures</code>
            </div>
          </div>
        </div>
      </div>

      <div class="protection-method">
        <div class="method-number">3</div>
        <div class="method-content">
          <h3>CAPTCHA aprÃ¨s plusieurs Ã©checs</h3>
          <p>Forcez l'attaquant Ã  prouver qu'il est humain aprÃ¨s X tentatives Ã©chouÃ©es.</p>
          
          <div class="code-block safe">
            <div class="code-header">
              <span class="code-status">âœ… Code sÃ©curisÃ©</span>
              <span class="code-lang">Python / Flask</span>
            </div>
            <pre><code>from flask import session

@app.route('/login', methods=['POST'])
def login():
    attempts = session.get('failed_login_attempts', 0)
    
    # AprÃ¨s 3 Ã©checs, demander un CAPTCHA
    if attempts >= 3:
        captcha = request.form.get('captcha')
        if not verify_captcha(captcha):
            return "CAPTCHA invalide"
    
    if verify_credentials(username, password):
        session['failed_login_attempts'] = 0
        return "Connexion rÃ©ussie"
    else:
        session['failed_login_attempts'] = attempts + 1
        return render_template('login.html', show_captcha=True)</code></pre>
          </div>

          <p style="margin-top: 15px;">
            Les CAPTCHA modernes (reCAPTCHA v3) fonctionnent de maniÃ¨re invisible et ne perturbent 
            pas les utilisateurs lÃ©gitimes tout en bloquant efficacement les bots.
          </p>
        </div>
      </div>

      <div class="protection-method">
        <div class="method-number">4</div>
        <div class="method-content">
          <h3>Verrouillage temporaire du compte</h3>
          <p>Bloquez complÃ¨tement le compte pendant X minutes aprÃ¨s Y tentatives Ã©chouÃ©es.</p>
          
          <ul>
            <li>Exemple : 5 Ã©checs = compte verrouillÃ© pendant 15 minutes</li>
            <li>Envoyez un email Ã  l'utilisateur lÃ©gitime pour le prÃ©venir</li>
            <li>Proposez une rÃ©initialisation de mot de passe par email</li>
            <li>Loggez toutes les tentatives suspectes pour analyse</li>
          </ul>

          <div class="success-box">
            <strong>âš ï¸ Attention :</strong> Cette mÃ©thode peut Ãªtre exploitÃ©e pour faire du dÃ©ni de service (DoS). 
            Un attaquant pourrait intentionnellement verrouiller des comptes lÃ©gitimes. 
            Combinez toujours avec d'autres protections.
          </div>
        </div>
      </div>

      <div class="protection-method">
        <div class="method-number">5</div>
        <div class="method-content">
          <h3>Politique de mots de passe robustes</h3>
          <p>Imposez des mots de passe difficiles Ã  deviner :</p>
          
          <div class="checklist">
            <div class="checklist-item">
              <span class="check">âœ…</span>
              <span>Minimum 12 caractÃ¨res (idÃ©alement 16+)</span>
            </div>
            <div class="checklist-item">
              <span class="check">âœ…</span>
              <span>MÃ©lange obligatoire : majuscules, minuscules, chiffres, symboles</span>
            </div>
            <div class="checklist-item">
              <span class="check">âœ…</span>
              <span>Interdire les mots de passe communs (liste noire)</span>
            </div>
            <div class="checklist-item">
              <span class="check">âœ…</span>
              <span>VÃ©rifier contre les bases de donnÃ©es de mots de passe compromis (Have I Been Pwned)</span>
            </div>
            <div class="checklist-item">
              <span class="check">âœ…</span>
              <span>Forcer le changement pÃ©riodique (tous les 6 mois)</span>
            </div>
            <div class="checklist-item">
              <span class="check">âœ…</span>
              <span>EmpÃªcher la rÃ©utilisation des 5 derniers mots de passe</span>
            </div>
          </div>

          <div class="example-box" style="margin-top: 20px;">
            <strong>Temps pour cracker selon la complexitÃ© :</strong>
            <code>â€¢ "password" (8 lettres) â†’ InstantanÃ©
â€¢ "Password123" (12 caractÃ¨res) â†’ Quelques heures
â€¢ "P@ssw0rd!2024" (13 caractÃ¨res mixtes) â†’ Plusieurs semaines
â€¢ "Tr0p!c@l_P@r@d!se_2024" (24 caractÃ¨res) â†’ Des millions d'annÃ©es</code>
          </div>
        </div>
      </div>

      <div class="protection-method">
        <div class="method-number">6</div>
        <div class="method-content">
          <h3>Authentification Ã  deux facteurs (2FA)</h3>
          <p>Ajoutez une couche de sÃ©curitÃ© supplÃ©mentaire au-delÃ  du mot de passe :</p>
          
          <ul>
            <li><strong>SMS/Email</strong> : Code temporaire envoyÃ© sur le tÃ©lÃ©phone ou email</li>
            <li><strong>Application d'authentification</strong> : Google Authenticator, Authy, etc.</li>
            <li><strong>ClÃ© de sÃ©curitÃ© physique</strong> : YubiKey, Titan Security Key</li>
            <li><strong>BiomÃ©trie</strong> : Empreinte digitale, reconnaissance faciale</li>
          </ul>

          <div class="success-box">
            <strong>Impact :</strong> MÃªme si l'attaquant trouve le mot de passe par bruteforce, 
            il ne pourra pas se connecter sans le second facteur d'authentification. 
            Le 2FA rÃ©duit le risque de compromission de <strong>99,9%</strong>.
          </div>
        </div>
      </div>
    </div>

    <!-- Section 5 -->
    <div class="course-section">
      <h2>ğŸ”¬ DÃ©tecter une attaque en cours</h2>
      <p>Comment savoir si votre systÃ¨me est victime d'un bruteforce ?</p>

      <div class="info-box">
        <div class="info-icon">ğŸš¨</div>
        <div class="info-content">
          <strong>Indicateurs d'une attaque :</strong>
          <ul style="margin: 10px 0;">
            <li>Nombre anormal de requÃªtes de connexion sur une courte pÃ©riode</li>
            <li>Multiples Ã©checs de connexion depuis la mÃªme IP</li>
            <li>Tentatives de connexion sur de nombreux comptes diffÃ©rents</li>
            <li>Pics de trafic inhabituels sur la page de login</li>
            <li>User-Agent suspects ou absents dans les logs</li>
          </ul>
        </div>
      </div>

      <h3>Outils de monitoring recommandÃ©s :</h3>
      <div class="attack-types">
        <div class="attack-type-card">
          <h4>ğŸ“Š Fail2Ban</h4>
          <p>Bannit automatiquement les IP suspectes aprÃ¨s X Ã©checs</p>
        </div>
        <div class="attack-type-card">
          <h4>ğŸ›¡ï¸ Cloudflare</h4>
          <p>Protection DDoS et rate limiting au niveau rÃ©seau</p>
        </div>
        <div class="attack-type-card">
          <h4>ğŸ“ˆ ELK Stack</h4>
          <p>Analyse en temps rÃ©el des logs d'authentification</p>
        </div>
      </div>
    </div>

    <!-- Section 6 -->
    <div class="course-section">
      <h2>ğŸ“ RÃ©sumÃ© des bonnes pratiques</h2>
      <div class="checklist">
        <div class="checklist-item">
          <span class="check">âœ…</span>
          <span>Limitez strictement le nombre de tentatives (rate limiting)</span>
        </div>
        <div class="checklist-item">
          <span class="check">âœ…</span>
          <span>ImplÃ©mentez un dÃ©lai progressif aprÃ¨s chaque Ã©chec</span>
        </div>
        <div class="checklist-item">
          <span class="check">âœ…</span>
          <span>Ajoutez un CAPTCHA aprÃ¨s 3-5 tentatives Ã©chouÃ©es</span>
        </div>
        <div class="checklist-item">
          <span class="check">âœ…</span>
          <span>Verrouillez temporairement les comptes aprÃ¨s trop d'Ã©checs</span>
        </div>
        <div class="checklist-item">
          <span class="check">âœ…</span>
          <span>Imposez des mots de passe robustes (12+ caractÃ¨res)</span>
        </div>
        <div class="checklist-item">
          <span class="check">âœ…</span>
          <span>Activez l'authentification Ã  deux facteurs (2FA)</span>
        </div>
        <div class="checklist-item">
          <span class="check">âœ…</span>
          <span>Surveillez les logs et dÃ©tectez les patterns suspects</span>
        </div>
        <div class="checklist-item">
          <span class="check">âœ…</span>
          <span>Ne rÃ©vÃ©lez jamais si le problÃ¨me vient du username ou du password</span>
        </div>
        <div class="checklist-item">
          <span class="check">âœ…</span>
          <span>Hashage sÃ©curisÃ© avec bcrypt/Argon2 (jamais MD5/SHA1)</span>
        </div>
      </div>
    </div>

    <!-- CTA Challenge -->
    <div class="challenge-cta">
      <div class="cta-content">
        <h2>ğŸ¯ PrÃªt Ã  pratiquer ?</h2>
        <p>
          Maintenant que vous comprenez les attaques par force brute, testez vos compÃ©tences sur notre challenge ! 
          Vous devrez utiliser une technique de bruteforce pour dÃ©couvrir un code secret Ã  4 chiffres.
        </p>
        <div class="cta-info">
          <div class="cta-detail">
            <span class="cta-icon">â­</span>
            <span><strong>100 points</strong></span>
          </div>
          <div class="cta-detail">
            <span class="cta-icon">ğŸ“</span>
            <span>Niveau dÃ©butant</span>
          </div>
          <div class="cta-detail">
            <span class="cta-icon">â±ï¸</span>
            <span>10-15 minutes</span>
          </div>
        </div>
        <a href="{{ url_for('challenge_view', challenge_id=3) }}" class="btn challenge-btn-large">
          AccÃ©der au challenge Bruteforce
        </a>
      </div>
    </div>

    <!-- Navigation -->
    <div class="course-navigation">
      <a href="{{ url_for('learn_xss') }}" class="nav-btn back">
        â† Cours prÃ©cÃ©dent : XSS
      </a>
      <a href="{{ url_for('learn_crypto') }}" class="nav-btn next">
        Cours suivants : Cryptographie â†’
      </a>
    </div>

  </div>

</section>
{% endblock %}